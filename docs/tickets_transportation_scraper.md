### 工单计划 · Liblib 汽车交通采集（可并行）

说明：每条含目标、输出、依赖、并行性与验收要点；时间为理想人日估算，用于排期参考。

1) T1 需求冻结与合规基线（0.5d）
- 输出：确认版 PRD（本仓 `docs/PRD_transportation_scraper.md`），限速与用途声明。
- 依赖：无；并行性：解锁所有任务。
- 验收：干系人确认，无待定项。

2) T2 API 样例与字段字典（1d）
- 输出：3 页列表 + 10 个详情 JSON 样例；字段字典（必填/可空/映射）。
- 依赖：T1；并行性：可与 T3 并行。
- 验收：样例归档，字段表齐备。

3) T3 数据模型与迁移（1d）
- 输出：MySQL DDL（见 PRD）与迁移脚本；本地/远程连接校验（使用 `.env`）。
- 依赖：T1；并行性：可与 T2 并行。
- 验收：表成功建于 `cardesignspace`，索引有效。

4) T4 列表采集器（1.5d）
- 输出：按标签=汽车交通调用 `img/group/search` 的分页采集；断点（页/游标）；速率限制；slug 队列。
- 依赖：T2,T3；并行性：与 T5 流水线式并行。
- 验收：给定页范围稳定产出 ≥1,000 slug；重试生效。

5) T5 详情采集器（2d）
- 输出：`group/get/{slug}`、`author/{slug}`、可选评论落库；字段校验与缺省策略。
- 依赖：T2,T3；并行性：与 T4 流水线；与 T6 局部并行。
- 验收：随机 200 条详情字段齐全率 ≥98%。

6) T6 媒体下载器（2d）
- 输出：并发下载图组到 S3（`S3_*`）；`x-oss-process` 控制格式与尺寸；失败重试与校验（大小/哈希）。
- 依赖：T3,T5；并行性：与 T5 后半段并行。
- 验收：下载成功率 ≥99%，命名与路径规范通过。

7) T7 限速/重试中间件（0.5d）
- 输出：全局 RPS、指数退避、熔断；随机 UA/可选代理；可配置化。
- 依赖：无；并行性：与 T4/T5/T6 并行集成。
- 验收：压测无 429/封禁；异常自动降载。

8) T8 断点续采与失败补偿（0.5d）
- 输出：持久化页码/slug 状态；失败队列定时重试；运行恢复验证。
- 依赖：T4,T5；并行性：可并行。
- 验收：中断后恢复不丢页、不重复入库。

9) T9 监控与日志（0.5d）
- 输出：结构化日志；阶段性统计；阈值告警接口预留。
- 依赖：无；并行性：可并行。
- 验收：日志样例与统计报表可导出。

10) T10 参数化与配置（0.5d）
- 输出：标签/排序/页范围/并发/存储路径通过 CLI/配置切换。
- 依赖：无；并行性：可并行。
- 验收：无需改码即可切换到其他标签。

11) T11 单元测试（1d）
- 输出：解析/重试/限速/断点核心逻辑测试，覆盖率 ≥70%。
- 依赖：T4-T8；并行性：部分并行。
- 验收：CI 通过，覆盖率报告。

12) T12 集成测试（0.5d）
- 输出：5 页→详情→下载 端到端演练与结果核对。
- 依赖：T4-T6；并行性：串行。
- 验收：一次跑通，无致命错误。

13) T13 与分析流水线对接（1d）
- 输出：与 `save_and_analyze_collected_data.py` 对齐的视图/表结构、读取示例与产出数据集；
  - 中文图表支持（全局字体），展示示例（TopN 模型、提示词词云、题材分布）。
- 依赖：T3,T5-T6；并行性：串行。
- 验收：一键完成“采集→清洗→分析→出图（中文）”。

14) T14 文档与运行手册（0.5d）
- 输出：README（安装、配置、运行、常见问题）、数据字典更新。
- 依赖：并行；并行性：可并行。
- 验收：新人 30 分钟内可跑通 POC。

15) T15 调度与部署（0.5d）
- 输出：本地定时任务/容器化；日更 03:00 增量；结果归档与历史留存策略。
- 依赖：T4-T6；并行性：串行。
- 验收：按日自动成功，生成日报。

16) T16 灰度放量与观察（0.5d）
- 输出：POC→1x→2x 放量策略与观察项；异常回退方案。
- 依赖：T12,T15；并行性：串行。
- 验收：在限速内稳定放量 7 天。

——
并行编排建议：T2/T3 并行 → T4/T5 流水线 → T6 与 T5 后半段并行；T7-T10 贯穿式并行；收尾 T11-T16 串并结合。


